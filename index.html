<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Data Display</title>
    
</head>

<style>

body {
    font-family: Arial, sans-serif;
    margin: 20px;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

th, td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
}

th {
    background-color: #f2f2f2;
}

button {
    padding: 5px 10px;
    margin: 5px;
    cursor: pointer;
}

#dataDisplay {
    margin-top: 20px;
}

p {
    font-size: 16px;
    margin: 5px 0;
}

</style>
<body>
    <input type="file" id="fileInput" />
    <div id="dataDisplay">

    <table id="dataTable">
        <!-- Data from Excel will be inserted here -->
    </table>



        <!-- Data from Excel will be inserted here -->
<div id="selectedValue">
<p>CDT0:400462000000:400462999999:12,13,14,15,16,17,18,19:PUBALI VISA:1111111</p>
<p>CDT1:409380000000:409380999999:12,13,14,15,16,17,18,19:VISA GOLD:1111111</p>
<p>CDT2:409416000000:409416999999:12,13,14,15,16,17,18,19:VISA CLASSIC:1111111</p>
<p>CDT3:44778005000000:44778005999999:12,13,14,15,16,17,18,19:VISA CORPORATE:1111111</p>
<p>CDT4:409384000000:409384999999:12,13,14,15,16,17,18,19:VISA CLASSIC DEBIT:1111111</p>
<p>CDT5:44778007000000:44778007999999:12,13,14,15,16,17,18,19:VISA CLASSIC DEBIT:1111111</p>
<p>CDT6:400000000000:499999999999:12,13,14,15,16,17,18,19:VISA:1111111</p>
<p>CDT7:539949000000:539949999999:12,13,14,15,16,17,18,19:MC CLASSIC DEBIT:1111111</p>
<p>CDT8:54067015000000:54067015999999:12,13,14,15,16,17,18,19:MC CORPORATE:1111111</p>
<p>CDT9:500000000000:599999999999:12,13,14,15,16,17,18,19:MASTERCARD:1111111</p>
<p>CDT10:222100000000:272099999999:12,13,14,15,16,17,18,19:MASTERCARD:1111111</p>
<p>CDT11:100000000000:199999999999:12,13,14,15,16,17,18,19:NPSB:1111111</p>
<p>CDT12:600000000000:699999999999:12,13,14,15,16,17,18,19:MASTERCARD:1111111</p>
<p>CDT13:639996000000:639996809999:12,13,14,15,16,17,18,19:TAKAPAY:1111111</p>
<p>EDT0:A0000000031010:VSDC:0010000000:D84004F800:D84000A800:000000:500001:99999999</p>
<p>EDT1:A0000000032010:VISA ELECT:0010000000:D84004F800:D84000A800:000000:500001:99999999</p>
<p>EDT2:A0000000033010:VISA INTERLINK:0010000000:D84004F800:D84000A800:000000:500001:99999999</p>
<p>EDT3:A0000000041010:MASTERCARD:0000000000:F45084800C:F45084800C:000000:500000:99999999</p>
<p>EDT4:A0000000043060:MAESTRO:0000000000:F45084800C:F45084800C:000000:500000:99999999</p>
<p>EDT5:A00000033301:UPI:0010000000:D800FC9800:084000A800:000000:500000:99999999</p>
<p>EDT6:A00000091010:TAKAPAY:0000000000:F45084800C:F45084800C:000000:500001:99999999</p>
<p>HDT:<span id="value1"></span>:<span id="value2"></span>:1:1:1:000<span id="nii"></span>:050:050:TK:115:90:60000<span id="nii2"></span>0000</p>
<p>TCT:<span id="add-1"></span>:<span id="add-2"></span>:<span id="add-3"></span>:<span id="add-4"></span>:<span id="add-5"></span>:<span id="dba-1"></span>:<span id="dba-2"></span>:6925:0000:0000:0000:0000:72752692</p>
<p>MRT:SALE:CASH WITHDRAWL:VOID:EMI SALE+:BATCH REPORT+:BATCH SETTLE:LOGON:ADMIN+</p>
<p>TXN:SALE=1:VOID=1:QRSALE=0:CASH=0:EMI=1:PREAUTH=0:ADJUST=0:SETTLEMENT=1:BALANCE=0:REFUND=0:SHOWTXN=0:LOGON=1:SALECOMPON=0:SALECOMPOFF=0:OFFLINE=0:TIPWITHSALE=0:REPORT=1</p>
<p>PMTTYP:CHIP=1:NFC=1:CASHNFC=0:MAG=1:MANUAL=0:FALLBACK=0:LAST4DIGIT=0:CVV2INPUT=0</p>
<p>LIMIT:999:999:100:99999999:50000:2000000:500000:3,6,9,12,18,24</p>
<p>SLIPPRINT:CUSTOMERCOPY=1:LOGON=1:CARDDETAILSREPORT=0:SETTLEDETAILSREPORT=0:ERRORTXN=1</p>
<p>EXPMASKING:EXPMASKMC=0:EXPMASKCC=0:EXPMASKDT=0:EXPMASKPREAUTH=0:EXPMASKDISP=0:EXPMASKSHOWTXN=0:EXPMASKEMI=0:EXPMASKERRRP=0</p>
<p>PANMASKING:PANMASKMC=1:PANMASKCC=0:PANMASKDT=1:PANMASKPREAUTH=2:PANMASKDISP=1:PANMASKSHOWTXN=2:PANMASKEMI=1:PANMASKERRRP=1</p>
<p>EMIBIN:5406701500000000,5406701599999999,16:4477800500000000,4477800599999999,16:4094160000000000,4094169999999999,16:4093800000000000,4093809999999999,16:4004620000000000,4004629999999999,16</p>
<p>CASHBIN:5406701500000000,5406701599999999,16:4477800500000000,4477800599999999,16:4094160000000000,4094169999999999,16:4093800000000000,4093809999999999,16:4004620000000000,4004629999999999,16:4093840000000000,4093849999999999,16:5399490000000000,5399499999999999,16:4477800700000000,4477800799999999,16</p>
<P>SIMBIN:BANGLALINK=<span id="bl"></span>:GRAMEENPHONE=<span id="gp"></span>:ROBI=<span id="robi"></span>:OTHERS=0</P>
<P>IPBIN:192.168.224.69:172.31.1.43:10.230.27.5:172.31.1.43:5300:5200:5300:5200</P>
<p>SUPPORTBIN:OFFICERNAME=<span id="officer"></span>:OFFICERMOBILE=<span id="officernumber"></span>:ENGNAME=MR.SUSANTA:ENGMOBILE=01618180562</p>	
</div>
<button id="saveButton">create per-file</button>
        <!-- Add more fields as needed -->
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
<script>


const excelData = [];

document.getElementById('fileInput').addEventListener('change', function(event) {
  const file = event.target.files[0];
  const reader = new FileReader();

  reader.onload = function(e) {
    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, { type: 'array' });
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

    excelData.push(...jsonData);
    renderTable(jsonData);
  };
  reader.readAsArrayBuffer(file);
});

function renderTable(data) {
  const table = document.getElementById('dataTable');
  table.innerHTML = '';

  const headerRow = document.createElement('tr');
  data[0].forEach(header => {
    const th = document.createElement('th');
    th.textContent = header;
    headerRow.appendChild(th);
  });

  const th = document.createElement('th');
  th.textContent = 'Action';
  headerRow.appendChild(th);
  table.appendChild(headerRow);

  data.slice(1).forEach((row, i) => {
    const tr = document.createElement('tr');

    row.forEach(cell => {
      const td = document.createElement('td');
      td.textContent = cell;
      tr.appendChild(td);
    });

    const actionTd = document.createElement('td');
    const btn = document.createElement('button');
    btn.textContent = 'Add';
    btn.addEventListener('click', () => {
      fillData(i + 1);
      tr.style.backgroundColor = 'lightblue';
      saveValueToFile();
    });
    actionTd.appendChild(btn);
    tr.appendChild(actionTd);
    table.appendChild(tr);
  });
}

function splitMeaningfully(text, maxLen) {
  const words = text.replace(/\t/g, ' ').split(' ');
  const result = [];
  let line = '';

  for (const word of words) {
    if ((line + ' ' + word).trim().length <= maxLen) {
      line += (line ? ' ' : '') + word;
    } else {
      result.push(line);
      line = word;
    }
  }
  if (line) result.push(line);
  return result;
}



function fillData(index) {
// old data clear
const spanIds = ['value1', 'value2', 'officer', 'officernumber', 'gp', 'robi', 'bl'];
for (let i = 1; i <= 5; i++) spanIds.push(`add-${i}`);
for (let i = 1; i <= 2; i++) spanIds.push(`dba-${i}`);
spanIds.forEach(id => {
const el = document.getElementById(id);
if (el) el.textContent = '';
});

// new data set
const row = excelData[index];
if (!row) return;

document.getElementById('value1').textContent = row[0] || '';
document.getElementById('value2').textContent = row[1] || '';
document.getElementById('officer').textContent = row[4] || '';
document.getElementById('officernumber').textContent = row[5] || '';

const addressLines = splitMeaningfully(row[3] || '', 28);
addressLines.forEach((line, i) => {
const el = document.getElementById(`add-${i + 1}`);
if (el) el.textContent = line;
});

const dbaLines = splitMeaningfully(row[2] || '', 21);
dbaLines.forEach((line, i) => {
const el = document.getElementById(`dba-${i + 1}`);
if (el) el.textContent = line;
});

const sim = (row[6] || '').toLowerCase();
document.getElementById('gp').textContent = sim === 'gp' ? '1' : '0';
document.getElementById('robi').textContent = ['robi', 'rb'].includes(sim) ? '1' : '0';
document.getElementById('bl').textContent = sim === 'banglalink' || sim === 'bl' ? '1' : '0';
}

	document.getElementById('saveButton').addEventListener('click', saveValueToFile);

 function saveValueToFile() {
    const selectedValue = document.getElementById('selectedValue').textContent;

	
    if (!selectedValue) {
        alert('No value selected');
        return;
    }
	
    let indices = [1660, 1661, 1662, 1663, 1664, 1665, 1666, 1667];
	let substring = indices.map(index => selectedValue.charAt(index+2)).join('');
	
	const fileName =substring + '.txt';
   

	
    const blob = new Blob([selectedValue], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);

    const a = document.createElement('a');
    a.href = url;
    a.download = fileName;
	
	
    document.body.appendChild(a);
    a.click();

    setTimeout(() => {
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }, 0);
}




	
</script>
</body>
</html>
